<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà 2569</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Sarabun', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2C3E50 0%, #3498db 50%, #2980b9 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes slideDown {
            from { 
                opacity: 0; 
                transform: translateY(-20px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .container {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 25px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.3);
            max-width: 650px;
            width: 100%;
            padding: 25px;
            position: relative;
            z-index: 1;
            border: 3px solid rgba(255, 255, 255, 0.5);
            max-height: 90vh;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
                border-radius: 15px;
                margin: 10px;
                max-height: 95vh;
            }
        }

        .header {
            text-align: center;
            margin-bottom: 25px;
            position: relative;
        }

        .header::before {
            content: '‚úàÔ∏èüéâüåü';
            font-size: 40px;
            display: block;
            margin-bottom: 10px;
            animation: bounce 2s infinite;
        }

        @media (max-width: 768px) {
            .header::before {
                font-size: 32px;
                margin-bottom: 8px;
            }
        }

        .header h1 {
            background: linear-gradient(135deg, #e74c3c, #f39c12, #e74c3c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            line-height: 1.3;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 20px;
            }
        }

        .holiday-badge {
            display: inline-block;
            background: linear-gradient(135deg, #f39c12, #e74c3c);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(243, 156, 18, 0.4);
        }

        @media (max-width: 768px) {
            .holiday-badge {
                font-size: 13px;
                padding: 6px 16px;
            }
        }

        .form-group {
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .form-group {
                margin-bottom: 18px;
            }
        }

        .form-section {
            display: none;
        }

        .form-section.show {
            display: block;
            animation: slideDown 0.5s ease-out;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .radio-group {
                gap: 10px;
            }
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            flex: 1;
            min-width: 120px;
        }

        @media (max-width: 768px) {
            .radio-option {
                padding: 10px 15px;
                min-width: 100px;
            }
        }

        @media (max-width: 480px) {
            .radio-option {
                flex: 1 1 100%;
                justify-content: center;
            }
        }

        .radio-option:hover {
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.2);
        }

        .radio-option input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #3498db;
        }

        .radio-option label {
            margin: 0;
            cursor: pointer;
            font-size: 16px;
            flex: 1;
        }

        @media (max-width: 768px) {
            .radio-option label {
                font-size: 15px;
            }
        }

        .radio-option label::before {
            content: '';
        }

        .radio-option input[type="radio"]:checked + label {
            color: #3498db;
            font-weight: 800;
        }

        .radio-option:has(input[type="radio"]:checked) {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .province-search-wrapper {
            position: relative;
        }

        .province-input-group {
            display: flex;
            gap: 10px;
            align-items: stretch;
        }

        .province-input-group input {
            flex: 1;
        }

        .dropdown-btn {
            padding: 14px 18px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @media (max-width: 768px) {
            .dropdown-btn {
                padding: 12px 15px;
                font-size: 14px;
                min-width: 40px;
            }
        }

        .dropdown-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .dropdown-btn:active {
            transform: translateY(0);
        }

        .province-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #3498db;
            border-top: none;
            border-radius: 0 0 12px 12px;
            max-height: 250px;
            overflow-y: auto;
            display: none;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            margin-top: 2px;
        }

        .province-suggestions.show {
            display: block;
        }

        .province-suggestion-item {
            padding: 12px 18px;
            cursor: pointer;
            transition: background 0.2s;
            border-bottom: 1px solid #f0f0f0;
        }

        @media (max-width: 768px) {
            .province-suggestion-item {
                padding: 10px 15px;
            }
        }

        .province-suggestion-item:hover {
            background: #e3f2fd;
        }

        .province-suggestion-item:last-child {
            border-bottom: none;
        }

        .province-other-input {
            margin-top: 10px;
            display: none;
        }

        .province-other-input.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        label {
            display: block;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 15px;
        }

        @media (max-width: 768px) {
            label {
                font-size: 14px;
            }
        }

        label::before {
            content: 'üéØ ';
        }

        .required {
            color: #e74c3c;
        }

        input[type="text"],
        input[type="number"],
        input[type="date"],
        select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s;
            font-family: inherit;
            background: white;
        }

        @media (max-width: 768px) {
            input[type="text"],
            input[type="number"],
            input[type="date"],
            select {
                padding: 10px 12px;
                font-size: 14px;
            }
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.15);
            transform: translateY(-2px);
        }

        input:disabled,
        select:disabled {
            background: #f5f5f5;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .employee-info {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            padding: 18px;
            border-radius: 15px;
            margin-top: 15px;
            display: none;
            border: 2px solid #81c784;
        }

        @media (max-width: 768px) {
            .employee-info {
                padding: 15px;
            }
        }

        .employee-info.show {
            display: block;
            animation: slideDown 0.4s ease-out;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 2px dashed #a5d6a7;
            gap: 10px;
        }

        @media (max-width: 768px) {
            .info-row {
                padding: 6px 0;
                font-size: 14px;
            }
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 700;
            color: #2e7d32;
        }

        .info-label::before {
            content: '‚úì ';
            color: #4caf50;
        }

        .info-value {
            color: #1b5e20;
            font-weight: 600;
            text-align: right;
        }

        .btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #e74c3c 0%, #f39c12 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
            position: relative;
            overflow: hidden;
        }

        @media (max-width: 768px) {
            .btn {
                padding: 14px;
                font-size: 16px;
            }
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(231, 76, 60, 0.5);
        }

        .btn:disabled {
            background: linear-gradient(135deg, #bdc3c7, #95a5a6);
            cursor: not-allowed;
            transform: none;
        }

        .error {
            color: #e74c3c;
            font-size: 13px;
            margin-top: 8px;
            display: none;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .error {
                font-size: 12px;
            }
        }

        .error::before {
            content: '‚ùå ';
        }

        .error.show {
            display: block;
        }

        .loading {
            text-align: center;
            color: #3498db;
            margin-top: 12px;
            display: none;
            font-weight: 600;
            animation: pulse 1.5s infinite;
        }

        .loading.show {
            display: block;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s;
            padding: 10px;
        }

        .modal-overlay.show {
            display: flex;
        }

        .duplicate-modal, .success-modal {
            background: white;
            border-radius: 25px;
            padding: 35px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            animation: zoomIn 0.4s;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .success-modal {
            max-width: 500px;
        }

        @media (max-width: 768px) {
            .duplicate-modal, .success-modal {
                padding: 25px 20px;
                border-radius: 15px;
                width: 95%;
            }
        }

        .duplicate-icon, .success-icon {
            font-size: 70px;
            margin-bottom: 15px;
        }

        .success-icon {
            animation: bounce 1s infinite;
        }

        @media (max-width: 768px) {
            .duplicate-icon, .success-icon {
                font-size: 50px;
            }
        }

        .duplicate-modal h2 {
            color: #f39c12;
            font-size: 24px;
            margin-bottom: 15px;
            font-weight: 800;
            line-height: 1.3;
        }

        .success-modal h2 {
            color: #27ae60;
            font-size: 24px;
            margin-bottom: 15px;
            font-weight: 800;
            line-height: 1.3;
        }

        @media (max-width: 768px) {
            .duplicate-modal h2,
            .success-modal h2 {
                font-size: 20px;
            }

            .duplicate-modal p {
                font-size: 14px;
            }
        }

        .duplicate-info {
            background: #fff3cd;
            border: 2px solid #f39c12;
            border-radius: 15px;
            padding: 18px;
            margin: 20px 0;
            text-align: left;
        }

        @media (max-width: 768px) {
            .duplicate-info {
                padding: 15px;
            }
        }

        .duplicate-info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f8d486;
            gap: 10px;
        }

        @media (max-width: 768px) {
            .duplicate-info-row {
                padding: 6px 0;
                font-size: 14px;
            }
        }

        .duplicate-info-row:last-child {
            border-bottom: none;
        }

        .duplicate-info-label {
            font-weight: 700;
            color: #856404;
        }

        .duplicate-info-value {
            color: #533f03;
            font-weight: 600;
            text-align: right;
            word-break: break-word;
        }

        .duplicate-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .duplicate-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 120px;
        }

        @media (max-width: 480px) {
            .duplicate-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .duplicate-btn {
                width: 100%;
            }
        }

        .btn-cancel {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
        }

        .btn-cancel:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(127, 140, 141, 0.4);
        }

        .btn-edit {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
        }

        .btn-edit:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(243, 156, 18, 0.4);
        }

        .summary-box {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
            border: 2px solid #e0e0e0;
        }

        @media (max-width: 768px) {
            .summary-box {
                padding: 15px;
            }
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #dee2e6;
            gap: 10px;
        }

        @media (max-width: 768px) {
            .summary-row {
                padding: 6px 0;
                font-size: 14px;
            }
        }

        .summary-row:last-child {
            border-bottom: none;
        }

        .summary-label {
            font-weight: 700;
            color: #495057;
        }

        .summary-value {
            color: #212529;
            font-weight: 600;
            text-align: right;
            word-break: break-word;
        }

        .blessing {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 18px;
            border-radius: 15px;
            margin-top: 20px;
            font-size: 16px;
            font-weight: 700;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .blessing {
                padding: 15px;
                font-size: 14px;
            }
        }

        .close-modal-btn {
            background: linear-gradient(135deg, #3498db, #2ecc71);
            color: white;
            border: none;
            padding: 14px 35px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }

        @media (max-width: 768px) {
            .close-modal-btn {
                padding: 12px 30px;
                font-size: 14px;
            }
        }

        .close-modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.4);
        }

        .help-text {
            font-size: 13px;
            color: #7f8c8d;
            margin-top: 6px;
        }

        @media (max-width: 768px) {
            .help-text {
                font-size: 12px;
            }
        }

        .help-text::before {
            content: '‚ÑπÔ∏è ';
        }

        .search-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }

        @media (max-width: 768px) {
            .search-btn {
                padding: 10px 15px;
                font-size: 13px;
            }
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .search-btn:active {
            transform: translateY(0);
        }

        .other-input {
            margin-top: 10px;
            display: none;
        }

        .other-input.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà</h1>
            <div class="holiday-badge">27 ‡∏ò.‡∏Ñ. 68 - 4 ‡∏°.‡∏Ñ. 69</div>
        </div>

        <form id="travelForm">
            <div class="form-group">
                <label for="employeeId">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô <span class="required">*</span></label>
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="employeeId" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô" style="flex: 1;">
                    <button type="button" id="searchBtn" class="search-btn">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                </div>
                <div class="error" id="employeeIdError"></div>
                <div class="loading" id="employeeLoading">üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
            </div>

            <div class="employee-info" id="employeeInfo">
                <div class="info-row">
                    <span class="info-label">‡∏ù‡πà‡∏≤‡∏¢</span>
                    <span class="info-value" id="division">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">‡πÅ‡∏ú‡∏ô‡∏Å</span>
                    <span class="info-value" id="department">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</span>
                    <span class="info-value" id="workgroup">-</span>
                </div>
            </div>

            <div class="form-section" id="restOfForm">
                <div class="form-group">
                    <label>‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î 27 ‡∏ò.‡∏Ñ. 68 - 4 ‡∏°.‡∏Ñ. 69 <span class="required">*</span></label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="travelYes" name="travelStatus" value="‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á" required>
                            <label for="travelYes">üöó ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="travelNo" name="travelStatus" value="‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á" required>
                            <label for="travelNo">üè† ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</label>
                        </div>
                    </div>
                </div>

                <div class="form-group" id="provinceGroup">
                    <label for="provinceInput">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ <span class="required">*</span></label>
                    <div class="province-search-wrapper">
                        <div class="province-input-group">
                            <input type="text" id="provinceInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å ‚ñº ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®..." autocomplete="off">
                            <button type="button" class="dropdown-btn" id="provinceDropdownBtn" title="‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î">‚ñº</button>
                        </div>
                        <div class="province-suggestions" id="provinceSuggestions"></div>
                    </div>
                    <input type="text" id="provinceOther" class="province-other-input" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏≠‡∏∑‡πà‡∏ô‡πÜ">
                    <input type="hidden" id="provinceValue">
                </div>

                <div class="form-group">
                    <label for="departureDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ <span class="required">*</span></label>
                    <input type="date" id="departureDate" min="2025-12-24" max="2026-01-04">
                    <p class="help-text">‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 27 ‡∏ò.‡∏Ñ. 68 - 4 ‡∏°.‡∏Ñ. 69</p>
                </div>

                <div class="form-group">
                    <label for="returnDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏•‡∏±‡∏ö <span class="required">*</span></label>
                    <input type="date" id="returnDate" min="2025-12-27" max="2026-01-07">
                    <div class="error" id="dateError"></div>
                    <p class="help-text" id="travelDays" style="display: none; color: #27ae60; font-weight: 600; margin-top: 10px;"></p>
                </div>

                <div class="form-group">
                    <label for="companion">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á <span class="required">*</span></label>
                    <select id="companion">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å --</option>
                        <option value="‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß">üë§ ‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</option>
                        <option value="‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß</option>
                        <option value="‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô">üë• ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô</option>
                        <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">üîÑ ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                    </select>
                    <input type="text" id="companionOther" class="other-input" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏≠‡∏∑‡πà‡∏ô‡πÜ">
                </div>

                <div class="form-group">
                    <label for="travelers">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á <span class="required">*</span></label>
                    <input type="number" id="travelers" min="1" max="20" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô">
                    <p class="help-text">‡∏£‡∏ß‡∏°‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢</p>
                </div>

                <div class="form-group" id="vehicleGroup">
                    <label for="vehicle">‡∏û‡∏≤‡∏´‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á <span class="required">*</span></label>
                    <select id="vehicle">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏≤‡∏´‡∏ô‡∏∞ --</option>
                        <option value="‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">üöó ‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</option>
                        <option value="‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå">üèçÔ∏è ‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå</option>
                        <option value="‡∏£‡∏ñ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞">üöå ‡∏£‡∏ñ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞</option>
                        <option value="‡∏£‡∏ñ‡πÑ‡∏ü">üöÜ ‡∏£‡∏ñ‡πÑ‡∏ü</option>
                        <option value="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏¥‡∏ô">‚úàÔ∏è ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏¥‡∏ô</option>
                    </select>
                </div>

                <div class="form-group" id="leaveTypeGroup">
                    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î <span class="required">*</span></label>
                    <div class="radio-group" style="flex-direction: column; gap: 10px;">
                        <div class="radio-option">
                            <input type="radio" id="leave0" name="leaveType" value="‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡∏≤" required>
                            <label for="leave0">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡∏≤</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="leave1" name="leaveType" value="‡∏•‡∏≤‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î 1 ‡∏ß‡∏±‡∏ô (5 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568)" required>
                            <label for="leave1">‡∏•‡∏≤‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î 1 ‡∏ß‡∏±‡∏ô<br><small style="color: #7f8c8d;">(5 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568)</small></label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="leave2" name="leaveType" value="‡∏•‡∏≤‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î 2 ‡∏ß‡∏±‡∏ô (5-6 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568)" required>
                            <label for="leave2">‡∏•‡∏≤‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î 2 ‡∏ß‡∏±‡∏ô<br><small style="color: #7f8c8d;">(5-6 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568)</small></label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="leave3" name="leaveType" value="‡∏•‡∏≤‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î 3 ‡∏ß‡∏±‡∏ô (5-7 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568)" required>
                            <label for="leave3">‡∏•‡∏≤‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î 3 ‡∏ß‡∏±‡∏ô<br><small style="color: #7f8c8d;">(5-7 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568)</small></label>
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn" id="submitBtn">
                    <span style="position: relative; z-index: 1;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                </button>
            </div>
        </form>
    </div>

    <div class="modal-overlay" id="duplicateModal">
        <div class="duplicate-modal">
            <div class="duplicate-icon">‚ö†Ô∏è</div>
            <h2>‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
            <p style="color: #666; margin-bottom: 20px;">‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏¢‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</p>
            
            <div class="duplicate-info" id="duplicateInfo"></div>

            <div class="duplicate-buttons">
                <button class="duplicate-btn btn-cancel" onclick="cancelEdit()">
                    ‚ùå ‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                </button>
                <button class="duplicate-btn btn-edit" onclick="confirmEdit()">
                    ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="successModal">
        <div class="success-modal">
            <div class="success-icon">‚úÖüéâ</div>
            <h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h2>
            
            <div class="summary-box" id="summaryBox"></div>

            <div class="blessing">
                ‚ú® ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏†‡∏≤‡∏û ‚ú®<br>
                üåü Bon Voyage! üåü<br>
                üéä Happy New Year! üéä
            </div>

            <button class="close-modal-btn" onclick="closeModalAndReset()">üéØ ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á</button>
        </div>
    </div>

    <script>
        const CONFIG = {
            SHEET_ID: '1wKOV-Nf6JqlE999kVBzcDOOqbTRZe1pxR9XZqtCXV6E',
            API_KEY: 'AIzaSyBNnRTY4_kk0AQqzNShKbhXsFpPcl7udqU',
            WEB_APP_URL: 'https://script.google.com/macros/s/AKfycbwGFh95w3ZvlMhbscaxb5OC32RwJeRIop0REar26ZUTzR9HuOb4L6wWsKTmDySgnUkN/exec'
        };

        let employeeData = null;
        let allEmployees = [];
        let existingData = null;
        let shouldDeleteOldData = false;
        
        const provinces = [
            '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', '‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£', '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°',
            '‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà', '‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå', '‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£', '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô', '‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤',
            '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó', '‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥', '‡∏ä‡∏∏‡∏°‡∏û‡∏£', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', '‡∏ï‡∏£‡∏±‡∏á', '‡∏ï‡∏£‡∏≤‡∏î', '‡∏ï‡∏≤‡∏Å',
            '‡∏ô‡∏Ñ‡∏£‡∏ô‡∏≤‡∏¢‡∏Å', '‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°', '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', '‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä', '‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå', '‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™', '‡∏ô‡πà‡∏≤‡∏ô',
            '‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨', '‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå', '‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå', '‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ', '‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤',
            '‡∏û‡∏∞‡πÄ‡∏¢‡∏≤', '‡∏û‡∏±‡∏á‡∏á‡∏≤', '‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á', '‡∏û‡∏¥‡∏à‡∏¥‡∏ï‡∏£', '‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡πÅ‡∏û‡∏£‡πà',
            '‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï', '‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°', '‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£', '‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô', '‡∏¢‡πÇ‡∏™‡∏ò‡∏£', '‡∏¢‡∏∞‡∏•‡∏≤', '‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î', '‡∏£‡∏∞‡∏ô‡∏≠‡∏á',
            '‡∏£‡∏∞‡∏¢‡∏≠‡∏á', '‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ', '‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ', '‡∏•‡∏≥‡∏õ‡∏≤‡∏á', '‡∏•‡∏≥‡∏û‡∏π‡∏ô', '‡πÄ‡∏•‡∏¢', '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©', '‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£', '‡∏™‡∏á‡∏Ç‡∏•‡∏≤',
            '‡∏™‡∏ï‡∏π‡∏•', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°', '‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß', '‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢', '‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ',
            '‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå', '‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢', '‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π', '‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á', '‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç', '‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ',
            '‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå', '‡∏≠‡∏∏‡∏ó‡∏±‡∏¢‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ',
            'üá®üá≥ ‡∏à‡∏µ‡∏ô', 'üáØüáµ ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô', 'üá∞üá∑ ‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ‡πÉ‡∏ï‡πâ', 'üá∞üá≠ ‡∏Å‡∏±‡∏°‡∏û‡∏π‡∏ä‡∏≤', 'üá±üá¶ ‡∏•‡∏≤‡∏ß', 'üá≤üá≤ ‡∏û‡∏°‡πà‡∏≤',
            'üá≤üáæ ‡∏°‡∏≤‡πÄ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢', 'üá∏üá¨ ‡∏™‡∏¥‡∏á‡∏Ñ‡πÇ‡∏õ‡∏£‡πå', 'üáªüá≥ ‡πÄ‡∏ß‡∏µ‡∏¢‡∏î‡∏ô‡∏≤‡∏°', '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'
        ];

        async function loadEmployeeData() {
            try {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${CONFIG.SHEET_ID}/values/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô!A2:D?key=${CONFIG.API_KEY}`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.values) {
                    allEmployees = data.values.map(row => ({
                        id: row[0],
                        division: row[1] || '-',
                        department: row[2] || '-',
                        workgroup: row[3] || '-'
                    }));
                }
            } catch (error) {
                console.error('Error loading employee data:', error);
            }
        }

        async function searchEmployee() {
            const employeeIdInput = document.getElementById('employeeId');
            const employeeId = employeeIdInput.value.trim().toUpperCase();
            const errorDiv = document.getElementById('employeeIdError');
            const loadingDiv = document.getElementById('employeeLoading');
            const infoDiv = document.getElementById('employeeInfo');
            const restOfForm = document.getElementById('restOfForm');

            if (!employeeId) {
                errorDiv.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô';
                errorDiv.classList.add('show');
                infoDiv.classList.remove('show');
                restOfForm.classList.remove('show');
                return;
            }

            loadingDiv.classList.add('show');
            errorDiv.classList.remove('show');
            infoDiv.classList.remove('show');
            restOfForm.classList.remove('show');

            try {
                const employee = allEmployees.find(emp => 
                    emp.id.toUpperCase() === employeeId
                );

                if (employee) {
                    const hasDuplicate = await checkDuplicateData(employeeId);
                    
                    loadingDiv.classList.remove('show');
                    
                    if (hasDuplicate) {
                        showDuplicateModal(existingData);
                        employeeIdInput.value = employeeId;
                        employeeData = employee;
                    } else {
                        employeeIdInput.value = employeeId;
                        document.getElementById('division').textContent = employee.division;
                        document.getElementById('department').textContent = employee.department;
                        document.getElementById('workgroup').textContent = employee.workgroup;
                        infoDiv.classList.add('show');
                        employeeData = employee;
                        
                        setTimeout(() => {
                            restOfForm.classList.add('show');
                        }, 300);
                    }
                } else {
                    loadingDiv.classList.remove('show');
                    errorDiv.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö';
                    errorDiv.classList.add('show');
                    employeeData = null;
                }
            } catch (error) {
                loadingDiv.classList.remove('show');
                errorDiv.textContent = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                errorDiv.classList.add('show');
                console.error('Error:', error);
            }
        }

        async function checkDuplicateData(employeeId) {
            try {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${CONFIG.SHEET_ID}/values/Travel Survey!A:M?key=${CONFIG.API_KEY}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    console.warn('Cannot check duplicate via API, allowing submission');
                    return false;
                }
                
                const data = await response.json();
                
                if (data.values && data.values.length > 1) {
                    const rows = data.values.slice(1);
                    const found = rows.find(row => row[1] && row[1].toUpperCase() === employeeId.toUpperCase());
                    
                    if (found) {
                        existingData = {
                            rowIndex: rows.indexOf(found) + 2,
                            timestamp: found[0] || '-',
                            employeeId: found[1] || '-',
                            division: found[2] || '-',
                            department: found[3] || '-',
                            workgroup: found[4] || '-',
                            travelStatus: found[5] || '-',
                            province: found[6] || '-',
                            departureDate: found[7] || '-',
                            returnDate: found[8] || '-',
                            companion: found[9] || '-',
                            travelers: found[10] || '-',
                            vehicle: found[11] || '-',
                            leaveType: found[12] || '-'
                        };
                        return true;
                    }
                }
                return false;
            } catch (error) {
                console.error('Error checking duplicate:', error);
                return false;
            }
        }

        function showDuplicateModal(data) {
            const duplicateInfo = document.getElementById('duplicateInfo');
            
            let infoHTML = `
                <div class="duplicate-info-row">
                    <span class="duplicate-info-label">‚è∞ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å:</span>
                    <span class="duplicate-info-value">${data.timestamp}</span>
                </div>
                <div class="duplicate-info-row">
                    <span class="duplicate-info-label">üë§ ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</span>
                    <span class="duplicate-info-value">${data.employeeId}</span>
                </div>
                <div class="duplicate-info-row">
                    <span class="duplicate-info-label">üöó ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span>
                    <span class="duplicate-info-value">${data.travelStatus}</span>
                </div>
            `;

            if (data.travelStatus === '‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á') {
                infoHTML += `
                    <div class="duplicate-info-row">
                        <span class="duplicate-info-label">üìç ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®:</span>
                        <span class="duplicate-info-value">${data.province}</span>
                    </div>
                    <div class="duplicate-info-row">
                        <span class="duplicate-info-label">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏õ:</span>
                        <span class="duplicate-info-value">${data.departureDate}</span>
                    </div>
                    <div class="duplicate-info-row">
                        <span class="duplicate-info-label">üîô ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏±‡∏ö:</span>
                        <span class="duplicate-info-value">${data.returnDate}</span>
                    </div>
                    <div class="duplicate-info-row">
                        <span class="duplicate-info-label">üë• ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô:</span>
                        <span class="duplicate-info-value">${data.travelers} ‡∏Ñ‡∏ô</span>
                    </div>
                `;
            }
            
            infoHTML += `
                <div class="duplicate-info-row">
                    <span class="duplicate-info-label">üìÖ ‡∏Å‡∏≤‡∏£‡∏•‡∏≤:</span>
                    <span class="duplicate-info-value">${data.leaveType}</span>
                </div>
            `;
            
            duplicateInfo.innerHTML = infoHTML;
            document.getElementById('duplicateModal').classList.add('show');
        }

        function cancelEdit() {
            document.getElementById('duplicateModal').classList.remove('show');
            document.getElementById('travelForm').reset();
            document.getElementById('employeeInfo').classList.remove('show');
            document.getElementById('restOfForm').classList.remove('show');
            employeeData = null;
            existingData = null;
            shouldDeleteOldData = false;
            document.getElementById('employeeId').focus();
        }

        function confirmEdit() {
            document.getElementById('duplicateModal').classList.remove('show');
            shouldDeleteOldData = true;
            
            document.getElementById('division').textContent = employeeData.division;
            document.getElementById('department').textContent = employeeData.department;
            document.getElementById('workgroup').textContent = employeeData.workgroup;
            document.getElementById('employeeInfo').classList.add('show');
            
            setTimeout(() => {
                document.getElementById('restOfForm').classList.add('show');
            }, 300);
        }

        document.getElementById('searchBtn').addEventListener('click', searchEmployee);
        document.getElementById('employeeId').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                searchEmployee();
            }
        });
        document.getElementById('employeeId').addEventListener('blur', async function() {
            if (!employeeData && this.value.trim()) {
                searchEmployee();
            }
        });

        const provinceInput = document.getElementById('provinceInput');
        const provinceSuggestions = document.getElementById('provinceSuggestions');
        const provinceValue = document.getElementById('provinceValue');
        const provinceOther = document.getElementById('provinceOther');
        const provinceDropdownBtn = document.getElementById('provinceDropdownBtn');

        provinceDropdownBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            
            if (provinceSuggestions.classList.contains('show')) {
                provinceSuggestions.classList.remove('show');
            } else {
                showAllProvinces();
                provinceInput.focus();
            }
        });

        provinceInput.addEventListener('focus', function() {
            if (!this.value.trim()) {
                showAllProvinces();
            }
        });

        function showAllProvinces() {
            provinceSuggestions.innerHTML = provinces.map(p => 
                `<div class="province-suggestion-item" data-value="${p}">${p}</div>`
            ).join('');
            provinceSuggestions.classList.add('show');
        }

        provinceInput.addEventListener('input', function() {
            const value = this.value.toLowerCase().trim();
            
            if (!value) {
                showAllProvinces();
                provinceValue.value = '';
                provinceOther.classList.remove('show');
                return;
            }

            const filtered = provinces.filter(p => 
                p.toLowerCase().includes(value) || 
                p.replace(/üá®üá≥|üáØüáµ|üá∞üá∑|üá∏üá¨|üá≤üáæ|üáªüá≥|üá∞üá≠|üá±üá¶|üá≤üá≤/g, '').trim().toLowerCase().includes(value)
            );

            if (filtered.length > 0) {
                provinceSuggestions.innerHTML = filtered.map(p => 
                    `<div class="province-suggestion-item" data-value="${p}">${p}</div>`
                ).join('');
                provinceSuggestions.classList.add('show');
            } else {
                provinceSuggestions.classList.remove('show');
            }
        });

        provinceSuggestions.addEventListener('click', function(e) {
            if (e.target.classList.contains('province-suggestion-item')) {
                const value = e.target.dataset.value;
                
                if (value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                    provinceInput.value = '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
                    provinceValue.value = '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
                    provinceOther.classList.add('show');
                    provinceOther.focus();
                } else {
                    provinceInput.value = value;
                    provinceValue.value = value;
                    provinceOther.classList.remove('show');
                    provinceOther.value = '';
                }
                
                provinceSuggestions.classList.remove('show');
            }
        });

        document.addEventListener('click', function(e) {
            if (!provinceInput.contains(e.target) && 
                !provinceSuggestions.contains(e.target) && 
                !provinceDropdownBtn.contains(e.target)) {
                provinceSuggestions.classList.remove('show');
            }
        });

        document.querySelectorAll('input[name="travelStatus"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const value = this.value;
                const provinceGroup = document.getElementById('provinceGroup');
                const departureDateGroup = document.querySelector('[for="departureDate"]').parentElement;
                const returnDateGroup = document.querySelector('[for="returnDate"]').parentElement;
                const companionGroup = document.querySelector('[for="companion"]').parentElement;
                const travelersGroup = document.querySelector('[for="travelers"]').parentElement;
                const vehicleGroup = document.getElementById('vehicleGroup');
                const leaveTypeGroup = document.getElementById('leaveTypeGroup');
                
                if (value === '‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á') {
                    // ‡∏ã‡πà‡∏≠‡∏ô‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á
                    provinceGroup.style.display = 'none';
                    departureDateGroup.style.display = 'none';
                    returnDateGroup.style.display = 'none';
                    companionGroup.style.display = 'none';
                    travelersGroup.style.display = 'none';
                    vehicleGroup.style.display = 'none';
                    
                    // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Ñ‡πà‡∏≤‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á
                    provinceInput.value = '';
                    provinceValue.value = '';
                    provinceOther.value = '';
                    provinceOther.classList.remove('show');
                    document.getElementById('departureDate').value = '';
                    document.getElementById('returnDate').value = '';
                    document.getElementById('companion').value = '';
                    document.getElementById('travelers').value = '';
                    document.getElementById('vehicle').value = '';
                    
                    // *** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡πÄ‡∏õ‡πá‡∏ô "‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡∏≤" ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ ***
                    document.getElementById('leave0').checked = true;
                    leaveTypeGroup.style.display = 'block'; // ‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ
                    
                } else if (value === '‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á') {
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á
                    provinceGroup.style.display = 'block';
                    departureDateGroup.style.display = 'block';
                    returnDateGroup.style.display = 'block';
                    companionGroup.style.display = 'block';
                    travelersGroup.style.display = 'block';
                    vehicleGroup.style.display = 'block';
                    leaveTypeGroup.style.display = 'block';
                }
            });
        });

        document.getElementById('companion').addEventListener('change', function() {
            const companionOther = document.getElementById('companionOther');
            const travelersInput = document.getElementById('travelers');
            
            if (this.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                companionOther.classList.add('show');
                companionOther.required = true;
            } else {
                companionOther.classList.remove('show');
                companionOther.required = false;
                companionOther.value = '';
            }

            if (this.value === '‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß') {
                travelersInput.value = '1';
                travelersInput.disabled = true;
            } else {
                travelersInput.disabled = false;
                if (travelersInput.value === '1') {
                    travelersInput.value = '';
                }
            }
        });

        function calculateTravelDays() {
            const departureDate = document.getElementById('departureDate').value;
            const returnDate = document.getElementById('returnDate').value;
            const errorDiv = document.getElementById('dateError');
            const daysDiv = document.getElementById('travelDays');

            if (departureDate && returnDate) {
                const start = new Date(departureDate);
                const end = new Date(returnDate);
                
                if (end < start) {
                    errorDiv.textContent = '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏±‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏õ';
                    errorDiv.classList.add('show');
                    daysDiv.style.display = 'none';
                } else {
                    errorDiv.classList.remove('show');
                    const diffTime = Math.abs(end - start);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
                    daysDiv.textContent = `üóìÔ∏è ‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á: ${diffDays} ‡∏ß‡∏±‡∏ô`;
                    daysDiv.style.display = 'block';
                }
            }
        }

        document.getElementById('departureDate').addEventListener('change', calculateTravelDays);
        document.getElementById('returnDate').addEventListener('change', calculateTravelDays);

        function formatThaiDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            const thaiMonths = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.', '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'];
            const day = date.getDate();
            const month = thaiMonths[date.getMonth()];
            const year = date.getFullYear() + 543;
            return `${day} ${month} ${year}`;
        }

        function showSuccessModal(formData) {
            const summaryBox = document.getElementById('summaryBox');
            
            let summaryHTML = `
                <div class="summary-row">
                    <span class="summary-label">üë§ ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</span>
                    <span class="summary-value">${formData.employeeId}</span>
                </div>
                <div class="summary-row">
                    <span class="summary-label">üöó ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span>
                    <span class="summary-value">${formData.travelStatus}</span>
                </div>
            `;

            if (formData.travelStatus === '‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á') {
                const start = new Date(formData.departureDate);
                const end = new Date(formData.returnDate);
                const diffTime = Math.abs(end - start);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;

                summaryHTML += `
                    <div class="summary-row">
                        <span class="summary-label">üìç ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®:</span>
                        <span class="summary-value">${formData.province}</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏õ:</span>
                        <span class="summary-value">${formatThaiDate(formData.departureDate)}</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">üîô ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏±‡∏ö:</span>
                        <span class="summary-value">${formatThaiDate(formData.returnDate)}</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">üóìÔ∏è ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô:</span>
                        <span class="summary-value">${diffDays} ‡∏ß‡∏±‡∏ô</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å:</span>
                        <span class="summary-value">${formData.companion}</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">üë• ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô:</span>
                        <span class="summary-value">${formData.travelers} ‡∏Ñ‡∏ô</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">üöó ‡∏û‡∏≤‡∏´‡∏ô‡∏∞:</span>
                        <span class="summary-value">${formData.vehicle}</span>
                    </div>
                `;
            }
            
            summaryHTML += `
                <div class="summary-row">
                    <span class="summary-label">üìÖ ‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î:</span>
                    <span class="summary-value">${formData.leaveType}</span>
                </div>
            `;
            
            summaryBox.innerHTML = summaryHTML;
            document.getElementById('successModal').classList.add('show');
        }

        function closeModalAndReset() {
            document.getElementById('successModal').classList.remove('show');
            document.getElementById('travelForm').reset();
            document.getElementById('employeeInfo').classList.remove('show');
            document.getElementById('restOfForm').classList.remove('show');
            document.getElementById('travelDays').style.display = 'none';
            document.getElementById('companionOther').classList.remove('show');
            document.getElementById('provinceOther').classList.remove('show');
            provinceInput.value = '';
            provinceValue.value = '';
            provinceSuggestions.classList.remove('show');
            employeeData = null;
            shouldDeleteOldData = false;
            existingData = null;
            
            const formGroups = document.querySelectorAll('#restOfForm .form-group');
            formGroups.forEach(group => {
                group.style.display = 'block';
            });
            
            document.getElementById('employeeId').focus();
        }

        document.getElementById('travelForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            console.log('üöÄ Form submission started');

            if (!employeeData) {
                alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                console.error('‚ùå No employee data');
                return;
            }

            const travelStatus = document.querySelector('input[name="travelStatus"]:checked');
            if (!travelStatus) {
                alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á');
                console.error('‚ùå No travel status selected');
                return;
            }
            
            console.log('‚úÖ Travel status:', travelStatus.value);

            const leaveType = document.querySelector('input[name="leaveType"]:checked');
            if (!leaveType) {
                alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤');
                console.error('‚ùå No leave type selected');
                console.log('Available leave options:');
                document.querySelectorAll('input[name="leaveType"]').forEach((r, i) => {
                    console.log(`  ${i+1}. Value: "${r.value}", Checked: ${r.checked}, Disabled: ${r.disabled}, Visible: ${r.closest('.radio-option')?.offsetParent !== null}`);
                });
                return;
            }
            
            console.log('‚úÖ Leave type selected:', leaveType.value);

            const travelStatusValue = travelStatus.value;

            if (travelStatusValue === '‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á') {
                let province = provinceValue.value;
                
                if (province === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                    const otherProvince = provinceOther.value.trim();
                    if (!otherProvince) {
                        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏≠‡∏∑‡πà‡∏ô‡πÜ');
                        provinceOther.focus();
                        return;
                    }
                    province = otherProvince;
                }
                
                if (!province) {
                    alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ');
                    provinceInput.focus();
                    return;
                }

                const departureDate = document.getElementById('departureDate').value;
                const returnDate = document.getElementById('returnDate').value;
                const companion = document.getElementById('companion').value;
                const travelers = document.getElementById('travelers').value;
                const vehicle = document.getElementById('vehicle').value;

                if (!departureDate || !returnDate || !companion || !travelers || !vehicle) {
                    alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                    return;
                }

                if (companion === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                    const companionOther = document.getElementById('companionOther').value.trim();
                    if (!companionOther) {
                        alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á');
                        return;
                    }
                }
            }

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span style="position: relative; z-index: 1;">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</span>';

            const companionValue = document.getElementById('companion').value;
            let finalCompanion = companionValue;
            if (companionValue === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                finalCompanion = document.getElementById('companionOther').value || companionValue;
            }

            let finalProvince = '-';
            if (travelStatusValue === '‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á') {
                if (provinceValue.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                    finalProvince = provinceOther.value || '-';
                } else {
                    finalProvince = provinceValue.value || '-';
                }
            }

            const formData = {
                timestamp: new Date().toLocaleString('th-TH', { timeZone: 'Asia/Bangkok' }),
                employeeId: document.getElementById('employeeId').value.toUpperCase(),
                division: employeeData.division,
                department: employeeData.department,
                workgroup: employeeData.workgroup,
                travelStatus: travelStatusValue,
                province: finalProvince,
                departureDate: document.getElementById('departureDate').value || '-',
                returnDate: document.getElementById('returnDate').value || '-',
                companion: finalCompanion || '-',
                travelers: document.getElementById('travelers').value || '-',
                vehicle: document.getElementById('vehicle').value || '-',
                leaveType: leaveType.value,
                isEdit: shouldDeleteOldData  // ‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ö‡∏≠‡∏Å Apps Script ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            };
            
            console.log('üìã Form Data:', formData);
            console.log('‚úèÔ∏è Is Edit?', shouldDeleteOldData);

            try {
                console.log('üì§ Sending data to:', CONFIG.WEB_APP_URL);
                console.log('üì¶ Data:', JSON.stringify(formData, null, 2));
                
                const response = await fetch(CONFIG.WEB_APP_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                console.log('üì• Response received');
                
                // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÉ‡∏ä‡πâ no-cors ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô response ‡πÑ‡∏î‡πâ
                // ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á success
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                console.log('‚úÖ Assuming success (no-cors mode)');
                showSuccessModal(formData);
                shouldDeleteOldData = false;
                existingData = null;

            } catch (error) {
                console.error('‚ùå Error:', error);
                
                // ‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î no-cors ‡πÅ‡∏°‡πâ error ‡∏Å‡πá‡∏≠‡∏≤‡∏à‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÑ‡∏î‡πâ
                // ‡πÅ‡∏™‡∏î‡∏á success modal ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Sheet
                alert('‚ö†Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏ô Google Sheet ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                
                showSuccessModal(formData);
                shouldDeleteOldData = false;
                existingData = null;
            }

            submitBtn.disabled = false;
            submitBtn.innerHTML = '<span style="position: relative; z-index: 1;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>';
        });

        loadEmployeeData();
    </script>
</body>
</html>

